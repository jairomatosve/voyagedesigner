# TravelOrchestrator - Setup & README

## ğŸš€ Quick Start

### 1. Clonar/Descargar el Proyecto
```bash
# Este cÃ³digo viene en Replit (abajo)
```

### 2. Setup Base de Datos (Supabase)

1. Ve a [supabase.com](https://supabase.com)
2. Crea un proyecto gratis
3. Copia las credenciales en `.env`
4. En Supabase SQL Editor, ejecuta el schema (Architecture.md - Base de Datos Schema)

### 3. Setup APIs (Llenarlas despuÃ©s)
```bash
# .env.local
VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
VITE_API_URL=http://localhost:3000
```

```bash
# backend/.env
SUPABASE_URL=your_supabase_url
SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_KEY=your_service_key
OPENAI_API_KEY=sk_... (llenar despuÃ©s)
ANTHROPIC_API_KEY=sk-ant-... (llenar despuÃ©s)
JWT_SECRET=your_secret_key_here
NODE_ENV=development
PORT=3000
```

### 4. Instalar Dependencias
```bash
# Backend
cd backend
npm install

# Frontend
cd ../frontend
npm install
```

### 5. Ejecutar
```bash
# Terminal 1 - Backend
cd backend
npm run dev

# Terminal 2 - Frontend
cd frontend
npm run dev
```

---

## ğŸ“‚ Estructura del Proyecto

```
TravelOrchestrator/
â”œâ”€ backend/
â”‚  â”œâ”€ src/
â”‚  â”‚  â”œâ”€ routes/
â”‚  â”‚  â”‚  â”œâ”€ auth.js
â”‚  â”‚  â”‚  â”œâ”€ trips.js
â”‚  â”‚  â”‚  â”œâ”€ itineraries.js
â”‚  â”‚  â”‚  â”œâ”€ activities.js
â”‚  â”‚  â”‚  â””â”€ ai.js (IA generaciÃ³n/reoptimizaciÃ³n)
â”‚  â”‚  â”œâ”€ middleware/
â”‚  â”‚  â”‚  â””â”€ auth.js
â”‚  â”‚  â”œâ”€ controllers/
â”‚  â”‚  â”‚  â”œâ”€ tripController.js
â”‚  â”‚  â”‚  â”œâ”€ aiController.js
â”‚  â”‚  â”‚  â””â”€ budgetController.js
â”‚  â”‚  â”œâ”€ services/
â”‚  â”‚  â”‚  â”œâ”€ openaiService.js
â”‚  â”‚  â”‚  â”œâ”€ claudeService.js
â”‚  â”‚  â”‚  â””â”€ supabaseService.js
â”‚  â”‚  â””â”€ app.js
â”‚  â”œâ”€ .env
â”‚  â””â”€ package.json
â”‚
â”œâ”€ frontend/
â”‚  â”œâ”€ src/
â”‚  â”‚  â”œâ”€ components/
â”‚  â”‚  â”‚  â”œâ”€ Auth/
â”‚  â”‚  â”‚  â”‚  â”œâ”€ LoginPage.jsx
â”‚  â”‚  â”‚  â”‚  â””â”€ SignupPage.jsx
â”‚  â”‚  â”‚  â”œâ”€ Trip/
â”‚  â”‚  â”‚  â”‚  â”œâ”€ TripCreator.jsx
â”‚  â”‚  â”‚  â”‚  â”œâ”€ TripDetail.jsx
â”‚  â”‚  â”‚  â”‚  â”œâ”€ ItineraryGenerator.jsx
â”‚  â”‚  â”‚  â”‚  â”œâ”€ ItineraryViewer.jsx
â”‚  â”‚  â”‚  â”‚  â”œâ”€ DayCard.jsx
â”‚  â”‚  â”‚  â”‚  â”œâ”€ ActivityCard.jsx
â”‚  â”‚  â”‚  â”‚  â””â”€ ReoptimizationPanel.jsx
â”‚  â”‚  â”‚  â”œâ”€ Reservation/
â”‚  â”‚  â”‚  â”‚  â””â”€ ReservationManager.jsx
â”‚  â”‚  â”‚  â”œâ”€ Budget/
â”‚  â”‚  â”‚  â”‚  â””â”€ BudgetTracker.jsx
â”‚  â”‚  â”‚  â””â”€ Shared/
â”‚  â”‚  â”‚     â”œâ”€ Header.jsx
â”‚  â”‚  â”‚     â””â”€ NotificationCenter.jsx
â”‚  â”‚  â”œâ”€ hooks/
â”‚  â”‚  â”‚  â”œâ”€ useAuth.js
â”‚  â”‚  â”‚  â”œâ”€ useTrips.js
â”‚  â”‚  â”‚  â””â”€ useRealtime.js
â”‚  â”‚  â”œâ”€ store/
â”‚  â”‚  â”‚  â””â”€ appStore.js (Zustand)
â”‚  â”‚  â”œâ”€ services/
â”‚  â”‚  â”‚  â”œâ”€ api.js
â”‚  â”‚  â”‚  â””â”€ supabaseClient.js
â”‚  â”‚  â”œâ”€ App.jsx
â”‚  â”‚  â””â”€ main.jsx
â”‚  â”œâ”€ .env.local
â”‚  â””â”€ package.json
â”‚
â”œâ”€ Architecture.md
â””â”€ README.md (este archivo)
```

---

## ğŸ› ï¸ Tech Stack Explicado

| TecnologÃ­a | Uso | Por quÃ© |
|-----------|-----|--------|
| **React 18** | UI frontend | Componentes reutilizables, hooks |
| **Vite** | Bundler | Desarrollo rÃ¡pido (HMR), builds optimizados |
| **Express** | API backend | Lightweight, rÃ¡pido, comunidad amplia |
| **Supabase** | DB + Auth + Realtime | PostgreSQL + Auth JWT + Subscriptions realtime |
| **Zustand** | State management | Minimal boilerplate vs Redux |
| **Axios** | HTTP client | Requests limpio |
| **TailwindCSS** | Styling | Utility-first, responsive design rÃ¡pido |
| **OpenAI API** | GeneraciÃ³n itinerario | GPT-4o Mini - balanceado costo/calidad |
| **Anthropic API** | ReoptimizaciÃ³n | Claude Haiku - rÃ¡pido y bueno para razonamiento |

---

## ğŸ” Flujo de AutenticaciÃ³n

```
1. User registra (email + password)
   â†’ Backend hashea password (bcrypt)
   â†’ Supabase crea user + auth token
   â†’ JWT token retornado al frontend
   
2. Frontend almacena JWT en localStorage
   
3. Cada request incluye JWT en headers
   â†’ Backend valida con middleware auth
   â†’ Si vÃ¡lido, continÃºa; si no, 401 Unauthorized
   
4. Logout: Frontend elimina JWT
```

---

## ğŸ¤– Flujo IA - GeneraciÃ³n de Itinerario

```
FRONTEND                          BACKEND                    IA
User presiona "Generate"
   â”‚
   â”œâ”€ POST /api/trips/:id/generate
   â”‚                                  â”œâ”€ Recopila datos trip
   â”‚                                  â”œâ”€ Construye prompt (destino, budget, preferencias)
   â”‚                                  â”œâ”€ Llama OpenAI GPT-4o Mini
   â”‚                                  â”‚                      â”œâ”€ Genera itinerario JSON
   â”‚                                  â”‚                      â””â”€ Retorna
   â”‚                                  â”œâ”€ Parsea respuesta
   â”‚                                  â”œâ”€ Guarda en DB (itineraries â†’ days â†’ activities)
   â”‚                                  â””â”€ Retorna itinerary ID
   â”‚
   â””â”€ Renderiza itinerario viaja a viaje
   
(Realtime: Otros miembros ven automÃ¡ticamente)
```

---

## ğŸ”„ Flujo IA - ReoptimizaciÃ³n

```
USER marks activity as "Failed"
   â”‚
   â”œâ”€ PUT /api/activities/:id/reoptimize
   â”‚                                  â”œâ”€ Busca actividades restantes hoy
   â”‚                                  â”œâ”€ Calcula presupuesto disponible
   â”‚                                  â”œâ”€ Construye prompt (dÃ­a actual, opciones)
   â”‚                                  â”œâ”€ Llama Claude Haiku
   â”‚                                  â”‚                      â”œâ”€ Analiza y sugiere cambios
   â”‚                                  â”‚                      â””â”€ Retorna opciones
   â”‚                                  â”œâ”€ Formatea sugerencias
   â”‚                                  â””â”€ Retorna al frontend
   â”‚
   â””â”€ Muestra "Reoptimization Suggestions"
      User aprueba/rechaza/modifica
      â””â”€ PUT /api/activities/batch â†’ actualiza DB
      
(Realtime: Todos ven el nuevo itinerario)
```

---

## ğŸ“Š CaracterÃ­sticas Fase 1

### âœ… AutenticaciÃ³n
- [x] Registro con email/password
- [x] Login/Logout
- [x] JWT session management
- [x] Cambio de contraseÃ±a (bÃ¡sico)

### âœ… Trips
- [x] Crear trip (destino, fechas, budget)
- [x] Editar trip
- [x] Eliminar trip
- [x] Listar mis trips
- [x] Roles dinÃ¡micos (organizer, member, viewer)
- [x] Invitar miembros por email

### âœ… Preferencias
- [x] Seleccionar intereses (cultural, food, nature, nightlife, etc)
- [x] Travel pace (relaxed, moderate, fast)
- [x] Accommodation type (budget, mid-range, luxury)
- [x] Dietary restrictions
- [x] Max activities/dÃ­a

### âœ… IA - Itinerario
- [x] Generar itinerario completo (GPT-4o Mini)
- [x] VisualizaciÃ³n dÃ­a a dÃ­a
- [x] Editar actividades manualmente
- [x] Agregar/eliminar actividades
- [x] Cambiar orden de actividades

### âœ… IA - ReoptimizaciÃ³n
- [x] Marcar actividad como "failed"
- [x] Claude Haiku sugiere alternativas
- [x] Visualizar impacto presupuestario
- [x] Aceptar/rechazar/modificar sugerencia
- [x] Actualizar itinerario en tiempo real

### âœ… Presupuesto
- [x] Trackear gastos por categorÃ­a
- [x] Ver desglose vs presupuesto
- [x] Alertas si excedes budget
- [x] Sumario gastos por miembro

### âœ… Reservas
- [x] CRUD reservas (vuelos, hoteles, tours)
- [x] Almacenar confirmation numbers
- [x] Links a booking confirmations
- [x] Almacenar en colecciÃ³n trip

### âœ… ColaboraciÃ³n
- [x] Realtime updates (Supabase subscriptions)
- [x] Ver cambios de otros miembros en vivo
- [x] Notificaciones (bÃ¡sicas)
- [x] Historial de cambios

---

## ğŸ§ª CÃ³mo Probar (Demo Mode)

Sin keys de IA, el app simula respuestas:

1. **Registra usuario** â†’ email: test@example.com, password: Test123!
2. **Crea trip** â†’ Destino: "Las Vegas", Fechas: 1-5 dÃ­as, Budget: $2000
3. **Selecciona preferencias** â†’ Intereses: cultural, nightlife
4. **Presiona "Generate Itinerary"** â†’ Ve itinerario simulado (JSON mockup)
5. **Edita actividades** â†’ Agregar/eliminar/cambiar orden
6. **Marca como "Failed"** â†’ Ve sugerencias simuladas de Claude
7. **Trackea budget** â†’ Agrega gastos, ve grÃ¡fico

---

## ğŸš¨ PrÃ³ximos Pasos (Cuando agregues Keys)

1. **Llenar .env con APIs**
   ```bash
   OPENAI_API_KEY=sk-...
   ANTHROPIC_API_KEY=sk-ant-...
   ```

2. **Testear IA real**
   - Genera itinerario â†’ IA real
   - Reoptimiza â†’ Claude real

3. **Integrar Google Maps API**
   - Distancias reales
   - Horarios de viaje
   - Mapas interactivos

4. **Agregar OpenWeather**
   - PronÃ³stico para fechas del viaje
   - Alertas climÃ¡ticas

5. **Implementar Fase 2**
   - Booking APIs
   - Skyscanner
   - Pagos

---

## ğŸ“ Soporte

Si algo no funciona:
1. Revisa `/backend/.env` y `/frontend/.env.local`
2. Chequea Supabase estÃ¡ corriendo (estado verde)
3. Mira console del navegador (F12) por errores
4. Backend logs: `npm run dev` en terminal

---

## ğŸ¯ El Futuro de TravelOrchestrator

**Fase 2:** APIs externas (Google Maps, Weather, Booking)
**Fase 3:** Mobile app nativa (React Native)
**Fase 4:** MonetizaciÃ³n (SaaS, subscription)
**Fase 5:** Analytics, integraciÃ³n con mÃ¡s servicios

---

**Â¡A viajar inteligentemente!** ğŸŒâœˆï¸
